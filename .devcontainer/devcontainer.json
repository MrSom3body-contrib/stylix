{
	"name": "Alpine",
	"image": "mcr.microsoft.com/devcontainers/base:alpine-3.20",

	"features": {
		"ghcr.io/devcontainers/features/nix:1": {
			"extraNixConfig": "extra-experimental-features = nix-command flakes, extra-substituters = https://stylix.cachix.org, extra-trusted-public-keys = stylix.cachix.org-1:iTycMb+viP8aTqhRDvV5qjs1jtNJKH9Jjvqyg4DYxhw=",
			"multiUser": true,
			"version": "latest"
		}
	},

	// Work around https://github.com/NixOS/nix/issues/6680#issuecomment-1230902525,
	// also install direnv and trust our .envrc so the developer shell is entered automatically
	"postCreateCommand":  [ "sudo", "apk", "add", "acl", "direnv" ],
	"postStartCommand": {
		"facl": [ "sudo", "setfacl", "-k", "/tmp" ],
		"direnv": [ "direnv", "allow", "${containerWorkspaceFolder}" ]
	},

	"customizations": {
		"vscode": {
			"extensions": [
				"jnoortheen.nix-ide",
				"mkhl.direnv"
			],
			"settings": {
				"direnv.restart.automatic": true,
				"direnv.status.showChangesCount": false
			}
		}
	}
}
